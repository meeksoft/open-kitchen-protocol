# Open Kitchen Protocol - Multi-Agent Example
# A complete multi-agent workflow with planning, implementation, and review

okp: "1.0"

agents:
  - id: planner
    provider: anthropic
    model: claude-sonnet-4-20250514
    role: planning
    capabilities:
      - decomposition
      - architecture
    
  - id: coder
    provider: openai
    model: gpt-4
    role: implementation
    capabilities:
      - coding
      - testing
    rate_limit:
      requests_per_minute: 60
      tokens_per_day: 100000
    
  - id: reviewer
    provider: google
    model: gemini-pro
    role: review
    capabilities:
      - code-review

workflow:
  - id: plan
    agent: planner
    action: decompose
    outputs:
      - task_plan
    timeout: "10m"
    
  - id: implement
    agent: coder
    action: execute
    depends_on:
      - plan
    inputs:
      plan: ${{ steps.plan.outputs.task_plan }}
    outputs:
      - code
      - tests
    timeout: "30m"
    retry:
      max_attempts: 2
      backoff: exponential
    
  - id: review
    agent: reviewer
    action: review
    depends_on:
      - implement
    inputs:
      code: ${{ steps.implement.outputs.code }}
    timeout: "15m"

handoff:
  mode: auto
  require_context: true
  fields:
    - what_done
    - what_pending

context:
  max_size: "50KB"
  transfer_mode: summary

task_backend: beads
